{"ast":null,"code":"import _regeneratorRuntime from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _defineProperty from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import ReactTooltip from'react-tooltip';import api from'../../../../services/api';import swal from'sweetalert';var OrderList=/*#__PURE__*/function(_Component){_inherits(OrderList,_Component);function OrderList(){var _getPrototypeOf2;var _this;_classCallCheck(this,OrderList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(OrderList)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={orders:[],users:[],contagem:'',detalha:[],cancela:'',vay:'',msg:'',n:'',ligado:false};_this.handleChange=function(e){_this.setState(_defineProperty({},e.target.name,e.target.value));};return _this;}_createClass(OrderList,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var respo,res,conta,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return api.get('/auth/status/1');case 2:respo=_context.sent;_context.next=5;return api.get('/auth/user');case 5:res=_context.sent;_context.next=8;return api.get('/auth/contagem');case 8:conta=_context.sent;_context.next=11;return api.get('/auth/order');case 11:response=_context.sent;if(response){this.setState({contagem:conta.data.contagem});this.setState({orders:response.data});this.setState({users:res.data});}if(respo.data['status']===1){this.setState({ligado:true});}else{this.setState({ligado:false});}case 14:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"detalhaProduto\",value:function(){var _detalhaProduto=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(order_id){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return api.get(\"/auth/order/\".concat(order_id));case 2:response=_context2.sent;if(response){this.setState({detalha:response.data});}case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function detalhaProduto(_x){return _detalhaProduto.apply(this,arguments);}return detalhaProduto;}()},{key:\"EntregaOOrder\",value:function EntregaOOrder(orderId){var _swal,_this2=this;swal((_swal={title:\"Você tem certeza?\",text:\"O Pedido será Entregue, Ja esta pronto?\",icon:\"warning\",buttons:true},_defineProperty(_swal,\"buttons\",[\"Cancelar\",\"Entregar\"]),_defineProperty(_swal,\"dangerMode\",true),_swal)).then(function(willDelete){if(willDelete){_this2.entrega(orderId);_this2.setState({msg:'Pedido Saiu para Entrega!',n:orderId});setTimeout(function(){this.setState({msg:'',n:''});}.bind(_this2),10000);}});}},{key:\"entrega\",value:function(){var _entrega=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(orderId){var id,entrega,payload,pay;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:id=orderId;_context3.next=3;return api.post(\"/auth/order/\".concat(id),{status:\"DELIVERED\"});case 3:entrega=_context3.sent;if(!entrega){_context3.next=12;break;}_context3.next=7;return api.get('/auth/order');case 7:payload=_context3.sent;_context3.next=10;return api.get('/auth/contagem');case 10:pay=_context3.sent;if(payload){this.setState({orders:payload.data,contagem:pay.data.contagem});}case 12:case\"end\":return _context3.stop();}}},_callee3,this);}));function entrega(_x2){return _entrega.apply(this,arguments);}return entrega;}()},{key:\"Parametros\",value:function Parametros(valor){// document.getElementById('campo').value = valor;\nthis.setState({cancela:valor});}},{key:\"CancelaOrder\",value:function(){var _CancelaOrder=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var ids,cancela,payload;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:ids=this.state.cancela;_context4.next=3;return api.post(\"/auth/order/\".concat(ids),{motivo:this.state.motivo,status:\"CANCELED\"});case 3:cancela=_context4.sent;this.setState({vay:'Pedido Cancelado!'});if(!cancela){_context4.next=11;break;}_context4.next=8;return api.get('/auth/order');case 8:payload=_context4.sent;if(payload){this.setState({orders:payload.data});}setTimeout(function(){this.setState({vay:''});window.location.reload();}.bind(this),2000);case 11:case\"end\":return _context4.stop();}}},_callee4,this);}));function CancelaOrder(){return _CancelaOrder.apply(this,arguments);}return CancelaOrder;}()},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,users=_this$state.users,orders=_this$state.orders,detalha=_this$state.detalha;return React.createElement(\"div\",{className:\"home\"},React.createElement(ReactTooltip,null),React.createElement(\"div\",{className:\"col s12\"},React.createElement(\"h3\",null,\"Central de pedidos\")),React.createElement(\"div\",{className:\"col s6 left\"},React.createElement(\"table\",{className:\"highlight\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Pedido\"),React.createElement(\"th\",null,\"Cliente\"),React.createElement(\"th\",null,\"Forma Pagamento\"),React.createElement(\"th\",null,\"Total R$\"),React.createElement(\"th\",null,\"Troco R$\"),React.createElement(\"th\",null,\"A\\xE7\\xF5es\"))),React.createElement(\"tbody\",null,orders.map(function(order){return order.status==='PENDING'?React.createElement(\"tr\",{key:order.id},React.createElement(\"td\",null,order.id),users.filter(function(users){return users.id===order.user_id;}).map(function(users){return React.createElement(\"td\",{key:users.id},users.name);}),React.createElement(\"td\",null,order.forma),React.createElement(\"td\",null,\"R$ 00,00\"),React.createElement(\"td\",null,order.change.toLocaleString('pt-br',{style:'currency',currency:'BRL'})),React.createElement(\"td\",null,React.createElement(ReactTooltip,null),React.createElement(\"a\",{onClick:function onClick(){return _this3.detalhaProduto(order.id);},rel:\"modal:open\",className:\"modal-trigger\",href:\"#detalha\",\"data-id\":order.id,\"data-tip\":\"Detalhes\",\"data-place\":\"left\",\"data-effect\":\"solid\"},React.createElement(\"div\",{className:\"btn-flat corPadrao darken-4\"},React.createElement(\"i\",{className:\"material-icons white-text\"},\"more\"))),\"\\xA0\",React.createElement(\"a\",{onClick:function onClick(){return _this3.EntregaOOrder(order.id);},\"data-tip\":\"Entregar\",\"data-place\":\"bottom\",\"data-effect\":\"solid\"},React.createElement(\"div\",{className:\"btn-flat corPadrao darken-4\"},React.createElement(\"i\",{className:\"material-icons white-text\"},\"send\"))),\"\\xA0 \\xA0\",React.createElement(\"a\",{onClick:function onClick(){return _this3.Parametros(order.id);},rel:\"modal:open\",href:\"#cancela\",\"data-id\":order.id,\"data-tip\":\"Cancelar Pedido\",\"data-place\":\"right\",\"data-effect\":\"solid\"},React.createElement(\"div\",{className:\"btn-flat corPadrao darken-4\"},React.createElement(\"i\",{className:\"material-icons white-text\"},\"cancel\"))))):'';})))),React.createElement(\"div\",{className:\"col s6 right\"},React.createElement(\"div\",{className:\"card ajuste\"},React.createElement(\"p\",null,\"Pedidos Aguardando Entrega!\"),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"bolinha\"},this.state.contagem===''?'':this.state.contagem),React.createElement(\"br\",null),React.createElement(\"p\",null,this.state.msg===''?'':this.state.msg+' - Nº: ',\" \",this.state.n))),React.createElement(\"div\",{className:\"modal tamanho\",id:\"detalha\"},React.createElement(\"div\",null,React.createElement(\"p\",null,\"Detalhes do Pedido\")),React.createElement(\"div\",null,React.createElement(\"div\",{className:\"tabelinha\"},React.createElement(\"table\",{className:\"striped\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Produto\"),React.createElement(\"th\",null,\"Quantidade\"),React.createElement(\"th\",null,\"Vlr Unit.\"))),React.createElement(\"tbody\",null,this.state.detalha==''?'':detalha.product.map(function(d){return React.createElement(\"tr\",{key:d.id},React.createElement(\"td\",null,d.name),React.createElement(\"td\",null,\"0\",d.pivot.qtd),React.createElement(\"td\",null,d.price));})))),React.createElement(\"div\",{className:\"total\"},React.createElement(\"div\",{className:\"left\"},\"observa\\xE7\\xF5es:\",this.state.detalha==''?'':detalha.product.map(function(d){return React.createElement(\"p\",{key:d.id},d.pivot.obs);})),React.createElement(\"br\",null),React.createElement(\"br\",null)),React.createElement(\"br\",null),React.createElement(\"div\",{className:\"total\"},React.createElement(\"div\",{className:\"valor right\"},\"Total: R$ 00,00\")))),React.createElement(\"div\",{className:\"modal tamanho\",id:\"cancela\"},React.createElement(\"input\",{id:\"campo\",name:\"cancela\",type:\"hidden\",value:\"\"}),React.createElement(\"div\",null,React.createElement(\"p\",null,\"Cancelar Pedido N\\xBA 0\",this.state.cancela),React.createElement(\"div\",{className:\"input-field col s12\"},React.createElement(\"i\",{className:\"material-icons prefix\"},\"cancel\"),React.createElement(\"textarea\",{className:\"validate\",name:\"motivo\",value:this.state.motivo,onChange:this.handleChange,required:true}),React.createElement(\"p\",{className:\"active\"},\"Motivo do Cancelamento\"),React.createElement(\"br\",null),React.createElement(\"p\",{className:\"cancela right\"},this.state.vay===''?'':this.state.vay),React.createElement(\"br\",null),React.createElement(\"a\",{onClick:function onClick(){return _this3.CancelaOrder();},className:\"right\",\"data-tip\":\"Cancelar Agora\",\"data-place\":\"right\",\"data-effect\":\"solid\"},React.createElement(\"div\",{className:\"btn-flat corPadrao darken-4\"},React.createElement(\"i\",{className:\"material-icons white-text\"},\"cancel\")))))));}}]);return OrderList;}(Component);export default OrderList;","map":{"version":3,"sources":["/home/belinglima/MEGAsync/TCC/Projetos/github-Salomao/web/src/pages/App/components/order/OrderList.js"],"names":["React","Component","ReactTooltip","api","swal","OrderList","state","orders","users","contagem","detalha","cancela","vay","msg","n","ligado","handleChange","e","setState","target","name","value","get","respo","res","conta","response","data","order_id","orderId","title","text","icon","buttons","then","willDelete","entrega","setTimeout","bind","id","post","status","payload","pay","valor","ids","motivo","window","location","reload","map","order","filter","user_id","forma","change","toLocaleString","style","currency","detalhaProduto","EntregaOOrder","Parametros","product","d","pivot","qtd","price","obs","CancelaOrder"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport ReactTooltip from 'react-tooltip'\nimport api from '../../../../services/api'\nimport swal from 'sweetalert';\n\nclass OrderList extends Component{\n\n  state = {\n    orders: [],\n    users: [],\n    contagem: '',\n    detalha: [],\n    cancela: '',\n    vay: '',\n    msg: '',\n    n: '',\n    ligado: false\n  }\n\n  handleChange = e => {\n    this.setState({\n      [e.target.name]: e.target.value\n    })\n  }\n\n  async componentDidMount() {\n    const respo = await api.get('/auth/status/1')\n    const res = await api.get('/auth/user')\n    const conta = await api.get('/auth/contagem')\n    const response = await api.get('/auth/order')\n    if(response) {\n      this.setState({ contagem: conta.data.contagem })\n      this.setState({ orders: response.data })\n      this.setState({ users: res.data })\n    }\n    \n    if (respo.data['status'] === 1){\n        this.setState({ ligado: true })\n    } else {\n        this.setState({ ligado: false })\n    }\n  }\n\n  async detalhaProduto(order_id) {\n    const response = await api.get(`/auth/order/${order_id}`);\n      if(response) {\n        this.setState({\n          detalha: response.data\n        })\n      }\n  }\n\n  EntregaOOrder(orderId) {\n    swal({\n      title: \"Você tem certeza?\",\n      text: \"O Pedido será Entregue, Ja esta pronto?\",\n      icon: \"warning\",\n      buttons: true,\n      buttons: [\"Cancelar\", \"Entregar\"],\n      dangerMode: true,\n    }).then((willDelete) => {\n      if (willDelete) {\n        this.entrega(orderId)\n        this.setState({\n          msg: 'Pedido Saiu para Entrega!',\n          n: orderId\n        })\n\n        setTimeout(\n          function() {\n              this.setState({msg: '', n: ''});\n          }\n          .bind(this),\n          10000\n        );\n      } \n    });\n  }\n\n  async entrega(orderId) {\n    const id = orderId;\n    const entrega = await api.post(`/auth/order/${id}`,{\n      status: \"DELIVERED\"\n    })\n\n    if(entrega) {\n      const payload = await api.get('/auth/order')\n      const pay = await api.get('/auth/contagem')\n      if(payload) {\n        this.setState({\n            orders: payload.data,\n            contagem: pay.data.contagem\n        })\n      }       \n    }\n  }\n\n  Parametros(valor) {\n    // document.getElementById('campo').value = valor;\n    this.setState({\n      cancela: valor\n    })\n  }\n\n    async CancelaOrder (){\n        const ids = this.state.cancela\n        const cancela = await api.post(`/auth/order/${ids}`,{\n          motivo: this.state.motivo,\n          status: \"CANCELED\"\n        })\n\n        this.setState({\n          vay: 'Pedido Cancelado!'\n        })\n\n        if(cancela) {\n          const payload = await api.get('/auth/order')\n          if(payload) {\n            this.setState({\n                orders: payload.data\n            })  \n        }\n\n        setTimeout(\n          function() {\n              this.setState({vay: ''});\n              window.location.reload()\n          }\n          .bind(this),\n          2000\n        );\n      }\n }\n\n \n  render() {\n    const { users, orders, detalha } = this.state;\n\n    return(\n      <div className=\"home\">\n      <ReactTooltip />\n        <div className=\"col s12\"><h3>Central de pedidos</h3></div>\n        <div className=\"col s6 left\">\n          <table className=\"highlight\">\n         \n            <thead>\n              <tr>\n                <th>Pedido</th>\n                <th>Cliente</th>\n                <th>Forma Pagamento</th>\n                <th>Total R$</th>\n                <th>Troco R$</th>\n                <th>Ações</th>\n              </tr>\n            </thead>\n            <tbody>\n            {orders.map( (order) => (\n            order.status === 'PENDING' ?\n            \n            <tr key={order.id}>\n                <td>{order.id}</td>\n                  {users\n                  .filter(users => users.id === order.user_id)\n                  .map(users => (\n                    <td key={users.id}>{users.name}</td>\n                  ))}\n                <td>{order.forma}</td>\n                <td>R$ 00,00</td>\n                {/* {order.product === undefined ? '' : (order.total).toLocaleString('pt-br', {style: 'currency', currency: 'BRL'})} */}\n                <td>{(order.change).toLocaleString('pt-br', {style: 'currency', currency: 'BRL'})}</td>\n                <td><ReactTooltip />\n                    <a \n                      onClick={() => this.detalhaProduto(order.id)} \n                      rel=\"modal:open\" className=\"modal-trigger\" href=\"#detalha\" \n                      data-id={order.id} \n                      data-tip=\"Detalhes\" \n                      data-place=\"left\" \n                      data-effect=\"solid\"\n                    >\n                    <div className=\"btn-flat corPadrao darken-4\">\n                      <i className=\"material-icons white-text\">more</i>\n                    </div>\n                  </a>\n                  &nbsp;\n                  <a \n                      onClick={() => this.EntregaOOrder(order.id)}  \n                      data-tip=\"Entregar\" \n                      data-place=\"bottom\" \n                      data-effect=\"solid\"\n                  >\n                    <div className=\"btn-flat corPadrao darken-4\">\n                      <i className=\"material-icons white-text\">send</i>\n                    </div>\n                  </a>\n                  &nbsp;\n                  &nbsp;\n                  <a \n                    onClick={() => this.Parametros(order.id)}\n                    rel=\"modal:open\" href=\"#cancela\" \n                    data-id={order.id} \n                    data-tip=\"Cancelar Pedido\" \n                    data-place=\"right\" \n                    data-effect=\"solid\"\n                  >\n                    <div className=\"btn-flat corPadrao darken-4\">\n                      <i className=\"material-icons white-text\">cancel</i>\n                    </div>\n                </a>\n              </td>\n            </tr>\n            : '' \n          ))}\n            \n            </tbody>\n          </table>\n        </div>\n        <div className=\"col s6 right\">\n         \n          <div className=\"card ajuste\">\n            <p>Pedidos Aguardando Entrega!</p> \n            <br />\n            <p className=\"bolinha\">{this.state.contagem === '' ? '' : this.state.contagem}</p>\n            <br />\n            <p>{this.state.msg === '' ? '' : this.state.msg + ' - Nº: '} {this.state.n}</p>\n          </div>\n        </div>\n\n\n        {/* detalhamento de pedido */}\n        <div className=\"modal tamanho\" id=\"detalha\">\n          <div>\n              <p>Detalhes do Pedido</p>\n          </div>\n          <div>\n            <div className=\"tabelinha\">\n            <table className=\"striped\">\n              <thead>\n                <tr>\n                  <th>Produto</th>\n                  <th>Quantidade</th>\n                  <th>Vlr Unit.</th>\n                </tr>\n              </thead>\n              <tbody>\n                {this.state.detalha == '' ? '' : \n                  detalha.product.map(d => (\n                    <tr key={d.id}>\n                      <td>{d.name}</td>\n                      <td>0{d.pivot.qtd}</td>\n                      <td>{d.price}</td>\n                    </tr>\n                  ))\n                }                \n              </tbody>\n            </table>\n          </div>\n\n          <div className=\"total\">\n              <div className=\"left\">\n                observações:\n                {this.state.detalha == '' ? '' : \n                  detalha.product.map(d => (\n                      <p key={d.id}>{d.pivot.obs}</p>\n                  ))\n                }      \n              </div>\n              <br />\n              <br />\n          </div>          \n          <br />\n          <div className=\"total\">\n              <div className=\"valor right\">\n                Total: R$ 00,00\n              </div>\n          </div>\n          </div>\n        </div>\n\n        {/* cancelmento de pedido */}\n        <div className=\"modal tamanho\" id=\"cancela\">\n        <input id=\"campo\" name=\"cancela\" type=\"hidden\" value=\"\" />\n          <div>\n              <p>Cancelar Pedido Nº 0{this.state.cancela}</p>\n              \n              <div className=\"input-field col s12\">\n                <i className=\"material-icons prefix\">cancel</i>\n                  <textarea className=\"validate\" \n                    name=\"motivo\"\n                    value={this.state.motivo}\n                    onChange={this.handleChange}\n                    required\n                  />\n                <p className=\"active\">Motivo do Cancelamento</p>\n                <br />\n                <p className=\"cancela right\">{this.state.vay === '' ? '' : this.state.vay}</p>\n                <br />\n                <a onClick={() => this.CancelaOrder()}\n                  className=\"right\" data-tip=\"Cancelar Agora\" data-place=\"right\" data-effect=\"solid\">\n                  <div className=\"btn-flat corPadrao darken-4\">\n                    <i className=\"material-icons white-text\">cancel</i>\n                  </div>\n                </a>\n              </div>\n          </div>\n        </div>\n\n      </div>\n    )\n  }\n}\n\nexport default OrderList"]},"metadata":{},"sourceType":"module"}